classdef StateObject < handle
    %BASEOBJECT Summary of this class goes here
    %   Detailed explanation goes here
    
    properties (Access = private)
        state;
        state_description;
    end
    
    properties (Constant)
        OFFLINE = 1;
        ONLINE = 2;
        ACTIVE = 3;
        UNKOWN = 4;
        ERROR = 5;
        STATE_STRINGS = {...
            'OFFLINE',...
            'ONLINE',...
            'ACTIVE',...
            'UNKNWON',...
            'ERROR'};
    end
    
    methods
        function this = StateObject()
            this.setStateOffline()
        end
        
        function state = getState(this)
            state = this.state;
        end
        
        function state_description = getStateDescription(this)
            state_description = this.state_description;
        end
        
        function state_change_message = setStateOffline(this, state_description)
            if nargin < 2
               state_description = '-Offline-'; 
            end
            this.setState(this.OFFLINE, state_description)
        end
        
        function state_change_message = setStateOnline(this, state_description)
            if nargin < 2
               state_description = '-Online-'; 
            end
            this.setState(this.ONLINE, state_description)
        end
        
        function state_change_message = setStateActive(this, state_description)
            if nargin < 2
               state_description = '-Active-'; 
            end
            this.setState(this.ACTIVE, state_description)
        end
        
        function state_change_message = setStateUnknown(this, state_description)
            if nargin < 2
               state_description = '-Unknown-'; 
            end
            this.setState(this.UNKOWN, state_description)
        end
        
        function state_change_message = setStateError(this, state_description)
            if nargin < 2
               state_description = '-Error-'; 
            end
            this.setState(this.ERROR, state_description)
        end
    end
    
    methods (Access = private)
        function state_change_message = setState(this,state, state_description)
            old_state = this.state;
            old_description = this.state_description;
            state_change_message = [...
                this.STATE_STRINGS(this.state), '(', this.state_description,')'...
                '-> ',...
                this.STATE_STRINGS(state), '(', state_description,')'];
            this.state = state;
            this.state_description = state_description;
        end
    end
end

